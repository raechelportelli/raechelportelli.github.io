<!DOCTYPE HTML>
<html lang="en">
  <head>
    <!-- basic leaflet code-->
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
     integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
     crossorigin=""/>
  
    <link rel="stylesheet" href="Style.css">

     <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
     integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
     crossorigin=""></script>
<!-- mbtiles files -->
    <script src="https://unpkg.com/sql.js@0.3.2/js/sql.js"></script>

      <script src="Leaflet.TileLayer.MBTiles.js"></script>  
    
<!-- leaflet-elevation -->

<link rel="stylesheet" href="https://unpkg.com/@raruto/leaflet-elevation/dist/leaflet-elevation.css" />
<script src="https://unpkg.com/@raruto/leaflet-elevation/dist/leaflet-elevation.js"></script>
  </head>
  
  <body>
     <div id="map"></div>
           	<script>
      
      	    //var map = new L.Map('map').fitWorld();
      		 var map = L.map('map').setView([42.43252,-84.00197]);
      	
      		var mb = L.tileLayer.mbTiles('new_tiles.mbtiles', {
      			minZoom: 10,
      			maxZoom: 15
      		}).addTo(map);
      	
      		mb.on('databaseloaded', function(ev) {
      			console.info('MBTiles DB loaded', ev);
      		});
      		mb.on('databaseerror', function(ev) {
      			console.info('MBTiles DB error', ev);
      		});

        let opts = {
        map: {
            center: [42.43252,-84.00197],
            zoom: 5,
            fullscreenControl: false,
            resizerControl: true,
            preferCanvas: true,
            rotate: true,
            // bearing: 45,
            rotateControl: {
                closeOnZeroBearing: true
            },
        },
        elevationControl: {
            url: "Woodstock.gpx",
            options: {
                theme: "lightblue-theme",
                collapsed: false,
                autohide: false,
                autofitBounds: true,
                position: "bottomleft",
                detached: true,
                summary: "inline",
                imperial: false,
                // altitude: "disabled",
                slope: "disabled",
                speed: false,
                acceleration: false,
                time: "summary",
                legend: true,
                followMarker: true,
                almostOver: true,
                distanceMarkers: false,
                hotline: false,
            },
        },


          
        layersControl: {
            options: {
                collapsed: false,
            },
        },
    };
   
    let controlElevation = L.control.elevation(opts.elevationControl.options).addTo(map);
    let controlLayer = L.control.layers(null, null, opts.layersControl.options);

    controlElevation.on('eledata_loaded', ({layer, name}) => controlLayer.addTo(map) && layer.eachLayer((trkseg) => trkseg.feature.geometry.type != "Point" && controlLayer.addOverlay(trkseg, trkseg.feature && trkseg.feature.properties && trkseg.feature.properties.name || name)));

    controlElevation.load(opts.elevationControl.url);

              
      	</script>
    
  </body>
